(function(d){d.fn.linedtextarea=function(n){var i=d.extend({},d.fn.linedtextarea.defaults,n),k=function(c,a,b){for(;c.height()-a<=0;){b==i.selectedLine?c.append("<div class='lineno lineselect'>"+b+"</div>"):c.append("<div class='lineno'>"+b+"</div>");b++}return b};return this.each(function(){var c=1,a=d(this);a.attr("wrap","off");a.css({resize:"none"});var b=a.outerWidth();a.wrap("<div class='linedtextarea'></div>");var e=a.parent().wrap("<div class='linedwrap' style='width:"+b+"px'></div>").parent();
e.prepend("<div class='lines' style='width:50px'></div>");var f=e.find(".lines");f.height(a.height()+6);f.append("<div class='codelines'></div>");var j=f.find(".codelines");c=k(j,f.height(),1);if(i.selectedLine!=-1&&!isNaN(i.selectedLine)){var h=parseInt(a.height()/(c-2));h=parseInt(h*i.selectedLine)-a.height()/2;a[0].scrollTop=h}h=f.outerWidth();var l=parseInt(e.css("border-left-width"))+parseInt(e.css("border-right-width"))+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")),o=b-l;
a.width(b-h-l-20);e.width(o);a.scroll(function(){var g=d(this)[0],m=g.scrollTop;g=g.clientHeight;j.css({"margin-top":-1*m+"px"});c=k(j,m+g,c)});a.resize(function(){var g=d(this)[0];f.height(g.clientHeight+6)})})};d.fn.linedtextarea.defaults={selectedLine:-1,selectedClass:"lineselect"}})(jQuery);
