jQuery(document).ready(function(){jQuery("a[rel=modal]").tangobox();jQuery("a[rel=modalImage]").tangobox()});
(function(a){a.fn.tangobox=function(c){function C(){if(!o){r=this;a.isFunction(c.callbackOnStart)&&c.callbackOnStart();a(document).bind("keyup",function(k){if(k.keyCode===27){o=true;y()}});a("#tbOverlay").length||a('<div id="tbOverlay"></div> \t\t\t\t\t\t\t\t<div id="tbWrap"> \t\t\t\t\t\t\t\t\t<div id="tbOuter"> \t\t\t\t\t\t\t\t\t\t<div id="tbInner"> \t\t\t\t\t\t\t\t\t\t\t<div id="tbContent"></div> \t\t\t\t\t\t\t\t\t\t\t<div id="tbNav"> \t\t\t\t\t\t\t\t\t\t\t\t<a id="tbNavPrev">Prev</a> \t\t\t\t\t\t\t\t\t\t\t\t<a id="tbNavNext">Next</a> \t\t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t\t\t<div id="tbMeta"><a id="tbClose">Close</a></div> \t\t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t\t</div>').appendTo("body");d=
a("#tbOuter");n=a("#tbContent");l=a("#tbMeta");if(c.overlayShow){var b={backgroundColor:c.overlayColor};if(jQuery.support.opacity)b.opacity=c.overlayOpacity;else b.filter="alpha(opacity="+c.overlayOpacity*100+")";a("#tbOverlay").css(b).fadeIn(200)}else a("#tbOverlay").hide();if(a(r).hasClass("tbNoSlideshow")){u=1;p=[r]}for(b=0;b<u;b++){i[b]={elem:p[b],href:a(p[b]).attr("href"),title:a(p[b]).attr("title"),alt:a(p[b]).find("> img").attr("alt"),rel:a(p[b]).attr("rel")};if(i[b].href==a(r).attr("href"))e=
b}t();c.slideshowAutostart&&z()}return false}function z(){if(c.slideshowDelay<=0)return false;q=setInterval(function(){if(!o){if(e==u-1)e=0;else++e;t()}},c.slideshowDelay);return true}function A(){clearInterval(q);q=null}function t(){if(o)return false;o=true;var b=i[e],k=b.alt||b.title||"";a("#tbNavPrev, #tbNavNext, #tbClose, #tbMeta").hide();d.is(":visible")===false&&d.css("top","120px").show();d.addClass("inProgress");if(b.href.match(/#/)){d.addClass("typeInline");v(a(window.location.hash).html(),
k,c.frameWidth,c.frameHeight)}else if(r.rel=="modalImage"||b.href.match(w)){d.addClass("typeImage");n.is(":visible")&&n.fadeOut();var g=new Image;g.onload=function(){var h=g.width,f=g.height,j=a(window).width()-120,m=a(window).height()-120;if(c.displayMeta)m-=l.outerHeight();if(c.imageScale&&(h>j||f>m)){j=Math.min(Math.min(j,h)/h,Math.min(m,f)/f);h=Math.round(j*h);f=Math.round(j*f)}v('<img alt="" id="tbImage" src="'+g.src+'" height="'+f+'" width="'+h+'">',k,h,f)};g.src=b.href}else{d.addClass("typeAjax");
a.get(b.href,function(h){for(var f={},j=b.elem.search.replace("?","").split("&"),m,s=j.length,x=0;x<s;x++){m=j[x].split("=");f[m[0]]=m[1]}v('<div id="tbInline">'+h+"</div>",k,f.width||c.frameWidth,f.height||c.frameHeight)})}return e}function v(b,k,g,h){g=parseInt(g);h=parseInt(h);var f=a(window).height(),j=a(window).scrollTop(),m=d.css("paddingTop").replace(/[^\d\.]/g,"")*2;f=f/2-(h+m)/2+j;var s=d.is(":visible")&&g==d.width()&&h==d.height()?{width:g}:{height:h+"px",width:g+"px"};l.find(":not(#tbClose)").remove();
if(c.displayMeta){f=f-l.outerHeight()/2+"px";l.append('<p id="tbMetaTitle">'+k+"</p>");if(i.length>1){l.find("#tbMetaTitle").after('<p id="tbMetaInfo">Viewing '+(e+1)+" of "+i.length+"</p>");if(c.slideshowDelay){l.find("p:last").append(a('<span><a href="" id="tbMetaSlideshow">'+(q?"Stop":"Start")+" slideshow</a></span>"));l.find("p:last a").click(function(){if(q){a(this).html("Start slideshow");a("#tbNav").show();A()}else{a(this).html("Stop slideshow");a("#tbNav").hide();z()}return false})}}}else f+=
"px";if(f!==d.css("top")){s.top=f;d.is(":visible")==false&&j!==0&&s.top.replace(/[^\d\.]/g,"")>j&&d.css("top",j+"px")}d.show();n.css("opacity",1).fadeOut("normal",function(){n.empty();n.html(a(b)).hide();d.animate(s,c.zoomSpeedIn,D)})}function D(){n.fadeIn("normal",function(){d.removeClass("inProgress");c.displayMeta?d.animate({height:d.height()+l.outerHeight()+"px"},c.zoomSpeedIn,function(){a("#tbClose, #tbMeta").show();B()}):B()})}function B(){var b=[];if(i.length-1>e)b[0]=i[e+1];if(e>0)b[1]=i[e-
1];for(var k in b){var g=b[k];if(g.rel=="modalImage"||g.href.match(w)){objNext=new Image;objNext.src=g.href}}if(i[e].rel=="modalImage"||i[e].href.match(w)){e!==0&&a("#tbNavPrev").show().unbind().click(function(){--e;t();return false});e!==i.length-1&&a("#tbNavNext").show().unbind().click(function(){++e;t();return false})}q!=null&&a("#tbNav").hide();a("#tbOuter.typeImage #tbContent, #tbClose").bind("click",y);a.isFunction(c.callbackOnShow)&&c.callbackOnShow(i[e]);o=false}function y(){A();a(document).unbind();
n.unbind().empty().stop();d.stop().css({height:"250px",width:"250px",top:"0"}).hide().removeAttr("class");a("#tbOverlay").fadeOut(c.zoomSpeedOut);a.isFunction(c.callbackOnClose)&&c.callbackOnClose(i[e]);return o=false}c=a.extend({imageScale:true,zoomOpacity:true,zoomSpeedIn:500,zoomSpeedOut:"slow",frameWidth:560,frameHeight:340,overlayShow:true,overlayOpacity:0.7,overlayColor:"#585858",slideshowAutostart:false,slideshowDelay:5200,displayMeta:true,callbackOnStart:null,callbackOnShow:null,callbackOnClose:null},
c);var p=this,r,u=p.length,i=[],e=0,o=false,q,w=/\.(jpe?g|gif|png)($|\?)?$/i,d,n,l;return this.unbind("click").bind("click",C)}})(jQuery);
